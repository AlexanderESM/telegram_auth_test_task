<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–û—Ç–ª–∞–¥–∫–∞ Telegram WebApp</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: sans-serif;
            margin: 2em;
        }
        .debug {
            background: #f5f5f5;
            border: 1px solid #ccc;
            padding: 1em;
            margin-top: 2em;
            white-space: pre-wrap;
            font-family: monospace;
        }
    </style>
</head>
<body>

<h1>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, <span th:text="${user.firstName} + ' ' + ${user.lastName}">–ì–æ—Å—Ç—å</span>!</h1>
<p><strong>ID:</strong> <span th:text="${user.id}">???</span></p>
<p><strong>Username:</strong> <span th:text="${user.username}">???</span></p>

<div class="debug" id="debug">–ó–∞–≥—Ä—É–∑–∫–∞ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏...</div>

<script>
    Telegram.WebApp.ready();

    const initData = Telegram.WebApp.initData;
    const now = new Date().toLocaleString();

    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º cookie –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
    if (initData && !document.cookie.includes("tg_init_data=")) {
        document.cookie = "tg_init_data=" + encodeURIComponent(initData)
            + "; path=/; SameSite=None; Secure";
    }

    // –í—ã–≤–æ–¥–∏–º –æ—Ç–ª–∞–¥–æ—á–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
    document.getElementById("debug").innerHTML = `
üïí –í—Ä–µ–º—è: ${now}
üì¶ initData:
${initData || '[–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö]'}

üç™ document.cookie:
${document.cookie || '[cookie –ø—É—Å—Ç]'}
    `;
</script>

</body>
</html>
